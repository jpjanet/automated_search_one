
\begin{figure}[H]
\begin{center}
\begin{tikzpicture}[node distance =  2.75cm,auto,fontscale=0.01]
\linespread{1}
\node [block] (complex) {TM \\ complex};
\node [block, below of = complex,label  = {[xshift=1.1cm, yshift=0cm, text width=2.5 cm,text centered,fontscale=0.25]{\color{darkgreen}{ \footnotesize +continous}  \color{black}{\footnotesize e.g. KI, $\delta\textrm{EN}$}}}] (encoder) {encoder};  
\node [block, right of = encoder,label  = {[xshift=0cm, yshift=-3cm, text width=2.5cm,text centered,fontscale=0.25]{\color{darkgreen}{\footnotesize +cheap  $ $} \color{black}{\footnotesize semiempirical  } \color{black}{\footnotesize+ NN/GP}}}] (surrogate) {surrogate \\ model};
\node [block, right of = surrogate, label  = {[xshift=0cm, yshift=0cm, text width=3cm,text centered,fontscale=0.25]{\color{darkgreen}{\footnotesize +space exploring} \color{black}{\footnotesize  e.g. expected imp.}}}] (continous_optimization) {surrogate \\ optim.};   
\node [block, right of = continous_optimization] (decoder) {decoder};
\node [block, above of = decoder] (outer_evaluation) {DFT};
\node [block, right of = outer_evaluation] (outer_opt) {outer \\ optim.};   
\node [block, above of = continous_optimization] (correction) {correction};
\path[line] (complex) -- node[above] {} (encoder);
\path[line] (encoder) -- node[above] {} (surrogate);
\path[line] (surrogate) -- node[above] {} (continous_optimization); 
\path[line,blue, dashed] (continous_optimization) -- node[above] {} (decoder); 
\path[line] (decoder) -- node[above] {} (outer_evaluation);   
\path[line] (outer_evaluation) -- node[above] {} (outer_opt);    
\path[line,dashed,blue] ([xshift=-2cm,yshift=0.5cm]complex.west) -- node[fontscale=0.25,label={[label distance=0.25cm]90:{initialize}}] {}([xshift=0cm,yshift=0.5cm]complex.west);
\path[line] (continous_optimization) |- ([xshift=0cm,yshift=-2.5cm]encoder.south)-| (encoder.south);
\path[line,dashed,red] (outer_evaluation.west) -- (correction.east);
\path[line,dashed,red] (correction) -| node[above] {\footnotesize Update} ([xshift=0cm,yshift=2cm]surrogate.north)-| (surrogate.north){};
\path[line] (outer_opt) |- ([xshift=-2.5cm,yshift=-6cm]complex.south)|- ([xshift=0cm,yshift=-0.5cm]complex.west);
\path[line, blue,dashed] (outer_opt.east) -- node {Output}([xshift=1.5cm,yshift=0cm]outer_opt.east);
\end{tikzpicture}
\end{center}
\caption{Schematic of envisioned design process at the completion of aim 2. \label{Fig:aim_2fc}}
\end{figure}
